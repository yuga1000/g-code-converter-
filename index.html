<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>G-code Converter</title>
<style>
body{
    font-family:Arial,Helvetica,sans-serif;
    max-width:600px;
    margin:40px auto;
    text-align:center;
}
#drop-area{
    border:2px dashed #666;
    padding:20px;
    cursor:pointer;
    margin-bottom:20px;
}
#drop-area.hover{background:#f0f0f0;}
#convert{padding:8px 16px;margin-bottom:20px;}
#download{display:none;margin-top:20px;}
</style>
</head>
<body>
<h1>G-code Converter</h1>
<div id="drop-area">Drop .gcode or .nc file here or click to choose<input type="file" id="fileInput" accept=".gcode,.nc" style="display:none"></div>
<button id="convert" disabled>Convert</button>
<br>
<a id="download">Download Converted File</a>
<script>
const dropArea=document.getElementById('drop-area');
const fileInput=document.getElementById('fileInput');
const convertBtn=document.getElementById('convert');
const downloadLink=document.getElementById('download');
let file;
function prevent(e){e.preventDefault();e.stopPropagation();}
function handleFiles(files){file=files[0];if(file)convertBtn.disabled=false;}
dropArea.addEventListener('click',()=>fileInput.click());
fileInput.addEventListener('change',()=>handleFiles(fileInput.files));
['dragenter','dragover'].forEach(eName=>dropArea.addEventListener(eName,e=>{prevent(e);dropArea.classList.add('hover');}));
['dragleave','drop'].forEach(eName=>dropArea.addEventListener(eName,e=>{prevent(e);dropArea.classList.remove('hover');}));
dropArea.addEventListener('drop',e=>{handleFiles(e.dataTransfer.files);});
convertBtn.addEventListener('click',()=>{
    if(!file)return;
    const reader=new FileReader();
    reader.onload=()=>{
        let text=reader.result;
        text=text.replace(/\bS1000\b/g,'Z-1 F100').replace(/\bS0\b/g,'Z1 F100');
        const blob=new Blob([text],{type:'text/plain'});
        const base=file.name.replace(/\.[^.]*$/, '');
        downloadLink.href=URL.createObjectURL(blob);
        downloadLink.download=base+'_converted.nc';
        downloadLink.style.display='inline';
    };
    reader.readAsText(file);
});
</script>
</body>
</html>
